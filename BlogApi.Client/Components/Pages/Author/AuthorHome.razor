@page "/author"


<div class="min-h-screen bg-gray-50 py-8">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 h-screen overflow-auto pb-15">

        <!-- Header with Stats -->
        <div class="mb-8">
            <div class="flex items-center justify-between mb-4">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Welcome back, Author! ✍️</h1>
                    <p class="text-gray-600">Manage your posts and content</p>
                </div>
                <button @onclick="CreateNewPost"
                        class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition-colors flex items-center gap-2 shadow-lg hover:shadow-xl">
                    <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    Create New Post
                </button>
            </div>

         
        </div>

        <!-- Filter Tabs -->
        <div class="bg-white rounded-2xl shadow-sm p-4 mb-6">
            <div class="flex gap-2">
                <button 
                        class="px-4 py-2 rounded-lg text-sm font-medium transition-colors @(currentFilter == "all" ? "bg-indigo-100 text-indigo-600" : "text-gray-600 hover:bg-gray-100")">
                    All Posts
                </button>
                <button 
                        class="px-4 py-2 rounded-lg text-sm font-medium transition-colors @(currentFilter == "published" ? "bg-green-100 text-green-600" : "text-gray-600 hover:bg-gray-100")">
                    Published
                </button>
                <button 
                        class="px-4 py-2 rounded-lg text-sm font-medium transition-colors @(currentFilter == "pending" ? "bg-yellow-100 text-yellow-600" : "text-gray-600 hover:bg-gray-100")">
                    Pending Approval
                </button>
                <button 
                        class="px-4 py-2 rounded-lg text-sm font-medium transition-colors @(currentFilter == "draft" ? "bg-gray-200 text-gray-700" : "text-gray-600 hover:bg-gray-100")">
                    Drafts
                </button>
            </div>
        </div>

        <!-- Posts Feed -->
        @if (filteredPosts?.Any() == true)
        {
            <div class="space-y-6">
                @foreach (var post in filteredPosts)
                {
                    <article class="bg-white rounded-2xl shadow-sm overflow-hidden hover:shadow-lg transition-all duration-300 cursor-pointer group">

                        <!-- Post Header -->
                        <div class="px-6 pt-6">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center gap-3">
                                    @if (post.Status == "published")
                                    {
                                        <span class="inline-block bg-green-100 text-green-600 px-3 py-1 rounded-full text-sm font-semibold">
                                            Published
                                        </span>
                                    }
                                    else if (post.Status == "pending")
                                    {
                                        <span class="inline-block bg-yellow-100 text-yellow-600 px-3 py-1 rounded-full text-sm font-semibold">
                                            Pending Approval
                                        </span>
                                    }
                                    else
                                    {
                                        <span class="inline-block bg-gray-200 text-gray-700 px-3 py-1 rounded-full text-sm font-semibold">
                                            Draft
                                        </span>
                                    }
                                </div>
                                <div class="flex items-center gap-2">
                                    <button @onclick="() => EditPost(post.Id)"
                                            @onclick:stopPropagation="true"
                                            class="p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors"
                                            title="Edit">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                        </svg>
                                    </button>
                                    <button @onclick="() => DeletePost(post.Id)"
                                            @onclick:stopPropagation="true"
                                            class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors"
                                            title="Delete">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <h2 class="text-2xl font-bold text-gray-900 mb-3 group-hover:text-indigo-600 transition-colors"
                                @onclick="() => ViewPost(post.Id)">
                                @post.Title
                            </h2>

                            <div class="flex items-center gap-4 text-sm text-gray-600 mb-4">
                                <div class="flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                    <span>You</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                    <span>@post.CreatedAt.ToString("MMM dd, yyyy")</span>
                                </div>
                                @if (post.Status == "published")
                                {
                                    <div class="flex items-center gap-2">
                                        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                        <span>@(post.Views / 60 + 5) min read</span>
                                    </div>
                                }
                            </div>
                        </div>

                        <!-- Post Excerpt -->
                        <div class="px-6 py-4">
                            <p class="text-gray-700 line-clamp-3 leading-relaxed">
                                @post.Excerpt
                            </p>
                        </div>

                        <!-- Post Footer -->
                        <div class="px-6 pb-6">
                            <div class="flex items-center justify-between pt-4 border-t border-gray-200">
                                <div class="flex items-center gap-6 text-sm text-gray-600">
                                    <div class="flex items-center gap-2">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                                        </svg>
                                        <span class="font-medium">@post.Likes</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                                        </svg>
                                        <span class="font-medium">@post.Comments</span>
                                    </div>
                                    @if (post.Status == "published")
                                    {
                                        <div class="flex items-center gap-2">
                                            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                            </svg>
                                            <span class="font-medium">@post.Views views</span>
                                        </div>
                                    }
                                </div>

                                <button @onclick="() => ViewPost(post.Id)"
                                        @onclick:stopPropagation="true"
                                        class="flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors group-hover:shadow-md">
                                    @if (post.Status == "draft")
                                    {
                                        <span>Edit Draft</span>
                                    }
                                    else if (post.Status == "pending")
                                    {
                                        <span>View</span>
                                    }
                                    else
                                    {
                                        <span>Read More</span>
                                    }
                                    <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </article>
                }
            </div>
        }
        else
        {
            <div class="bg-white rounded-2xl shadow-sm p-12 text-center">
                <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">No posts found</h3>
                <p class="text-gray-600 mb-4">@GetEmptyMessage()</p>
                <button @onclick="CreateNewPost"
                        class="inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-lg font-semibold hover:bg-indigo-700 transition-colors">
                    <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    Create Your First Post
                </button>
            </div>
        }
    </div>
</div>

<style>
    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>

@code {
    private int totalPosts => myPosts?.Count ?? 0;
    private int publishedPosts => myPosts?.Count(p => p.Status == "published") ?? 0;
    private int pendingPosts => myPosts?.Count(p => p.Status == "pending") ?? 0;
    private int bookmarksCount = 12; // This will be loaded from API later
    private string currentFilter = "all";

    private List<AuthorPost>? myPosts;
    private List<AuthorPost>? filteredPosts;

    public class AuthorPost
    {
        public int Id { get; set; }
        public string Title { get; set; } = string.Empty;
        public string Excerpt { get; set; } = string.Empty;
        public string Status { get; set; } = "draft"; // draft, pending, published
        public DateTime CreatedAt { get; set; }
        public int Likes { get; set; }
        public int Comments { get; set; }
        public int Views { get; set; }
    }

    protected override async Task OnInitializedAsync()
    {
        await LoadData();
    }

    private async Task LoadData()
    {
        // Simulate loading
        await Task.Delay(300);

        // Sample posts
        myPosts = new List<AuthorPost>
        {
            new AuthorPost
            {
                Id = 1,
                Title = "Getting Started with CQRS and MediatR in .NET",
                Excerpt = "Command Query Responsibility Segregation (CQRS) is a powerful architectural pattern that separates read and write operations into different models. When combined with MediatR, it provides a clean and maintainable way to structure your .NET applications. In this comprehensive guide, we'll explore how to implement CQRS patterns effectively.",
                Status = "published",
                CreatedAt = DateTime.Now.AddDays(-10),
                Likes = 124,
                Comments = 15,
                Views = 1250
            },
            new AuthorPost
            {
                Id = 2,
                Title = "Advanced Blazor Component Patterns",
                Excerpt = "Explore advanced patterns for building reusable Blazor components. Learn about component communication, state management, and how to create highly maintainable component libraries that scale with your application needs.",
                Status = "pending",
                CreatedAt = DateTime.Now.AddDays(-3),
                Likes = 0,
                Comments = 0,
                Views = 0
            },
            new AuthorPost
            {
                Id = 3,
                Title = "Entity Framework Core Performance Tips",
                Excerpt = "Optimize your EF Core queries for better performance. This article covers the top 10 performance tips every developer should know, from query optimization to proper use of tracking and AsNoTracking methods for efficient database operations.",
                Status = "published",
                CreatedAt = DateTime.Now.AddDays(-20),
                Likes = 89,
                Comments = 12,
                Views = 890
            },
            new AuthorPost
            {
                Id = 4,
                Title = "Building Microservices with .NET",
                Excerpt = "A comprehensive guide to microservices architecture using .NET. Learn how to design, build, and deploy scalable microservices that communicate effectively and maintain data consistency across distributed systems.",
                Status = "draft",
                CreatedAt = DateTime.Now.AddDays(-1),
                Likes = 0,
                Comments = 0,
                Views = 0
            },
            new AuthorPost
            {
                Id = 5,
                Title = "Understanding Clean Architecture",
                Excerpt = "Deep dive into clean architecture principles and patterns for .NET applications. Discover how to structure your code for maximum maintainability, testability, and flexibility while keeping your business logic independent of frameworks.",
                Status = "published",
                CreatedAt = DateTime.Now.AddDays(-30),
                Likes = 201,
                Comments = 28,
                Views = 2100
            },
            new AuthorPost
            {
                Id = 6,
                Title = "Docker Containers for .NET Developers",
                Excerpt = "Learn how to containerize your .NET applications with Docker. This guide walks through creating efficient Dockerfiles, multi-stage builds, and deploying your containerized applications to production environments.",
                Status = "pending",
                CreatedAt = DateTime.Now.AddDays(-2),
                Likes = 0,
                Comments = 0,
                Views = 0
            }
        };

        FilterPosts("all");
    }

    private void FilterPosts(string filter)
    {
        currentFilter = filter;
        filteredPosts = filter switch
        {
            "published" => myPosts?.Where(p => p.Status == "published").ToList(),
            "pending" => myPosts?.Where(p => p.Status == "pending").ToList(),
            "draft" => myPosts?.Where(p => p.Status == "draft").ToList(),
            _ => myPosts
        };
        StateHasChanged();
    }

    private void CreateNewPost()
    {
        Navigation.NavigateTo("/create-post");
    }

    private void EditPost(int postId)
    {
        Navigation.NavigateTo($"/edit-post/{postId}");
    }

    private void DeletePost(int postId)
    {
        // Implement delete logic
        Console.WriteLine($"Delete post {postId}");
    }

    private void ViewPost(int postId)
    {
        Navigation.NavigateTo($"/viewblogconstruct/{postId}");
    }

    private string GetEmptyMessage()
    {
        return currentFilter switch
        {
            "published" => "You don't have any published posts yet.",
            "pending" => "No posts waiting for approval.",
            "draft" => "You don't have any drafts.",
            _ => "Start creating amazing content today!"
        };
    }
}